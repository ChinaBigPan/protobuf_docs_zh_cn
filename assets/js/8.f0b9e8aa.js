(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{353:function(s,t,n){"use strict";n.r(t);var a=n(43),e=Object(a.a)({},(function(){var s=this,t=s.$createElement,n=s._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"命令行"}},[s._v("命令行")]),s._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/protobufjs/protobuf.js#command-line",target:"_blank",rel:"noopener noreferrer"}},[s._v("英文原地址"),n("OutboundLink")],1)]),s._v(" "),n("p",[s._v("命令行接口(CLI，Command Line Interface)可用于转换文件之间的格式，并生成静态代码以及 TypeScript 的定义。")]),s._v(" "),n("h2",{attrs:{id:"javascript"}},[s._v("JavaScript")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 转换文件格式并生成静态代码。")]),s._v("\n\n  -t, --target     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定目标格式。也接受需要自定义目标的路径。")]),s._v("\n\n                   json          "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# JSON 表示")]),s._v("\n                   json-module   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# JSON 表示为模块")]),s._v("\n                   proto2        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Protocol Buffers, 版本 2")]),s._v("\n                   proto3        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Protocol Buffers, 版本 3")]),s._v("\n                   static        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 无反射静态代码(本身是无功能的)")]),s._v("\n                   static-module "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 作为模块的无反射静态代码")]),s._v("\n\n  -p, --path       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将目录添加到要包含的路径.")]),s._v("\n\n  -o, --out        "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存到一个文件，而非写到标准输出流中.")]),s._v("\n\n  --sparse         "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仅导出从主文件引用的那些类型(实验功能) ")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仅模块目标:")]),s._v("\n\n  -w, --wrap       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定要使用的封装。还接受引入自定义封装的路径。 ")]),s._v("\n\n                   default   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认封装支持 CommonJS 和 AMD")]),s._v("\n                   commonjs  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CommonJS ")]),s._v("\n                   amd       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# AMD ")]),s._v("\n                   es6       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ES6")]),s._v("\n                   closure   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加到 protobuf.roots 的闭包，protobuf 是全局变量 ")]),s._v("\n\n  -r, --root       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定 protobuf.roots 的名称")]),s._v("\n\n  -l, --lint       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Linter 的配置. 默认采用 protobuf.js-compatible 规则：")]),s._v("\n                   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# eslint-disable block-scoped-var, no-redeclare, no-control-regex, no-prototype-builtins")]),s._v("\n\n  --es6            "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启用 ES6 语法 (const/let 代替 var)")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仅针对 Proto :")]),s._v("\n\n  --keep-case      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保持原字段大小写，并不会转换为驼峰 ")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 仅针对静态目标：")]),s._v("\n\n  --no-create      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不生成用于反射兼容性的创建函数.")]),s._v("\n  --no-encode      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不生成编码函数.")]),s._v("\n  --no-decode      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不生成解码函数.")]),s._v("\n  --no-verify      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不生成验证函数.")]),s._v("\n  --no-convert     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不生成类似 from/foObject 的转换函数")]),s._v("\n  --no-delimited   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不生成带分隔符的编码/解码函数.")]),s._v("\n  --no-beautify    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不美化生成的代码.")]),s._v("\n  --no-comments    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不输出任何 JSDoc 注释")]),s._v("\n\n  --force-long     "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制对 s-/u-/int64 和 s-/fixed64 字段使用 Long.")]),s._v("\n  --force-number   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制对 s-/u-/int64 和 s-/fixed64 字段使用 number.")]),s._v("\n  --force-message  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制使用信息实例而非普通对象.")]),s._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#用法: ")]),s._v("\npbjs "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" file1.proto file2.json "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("or pipe"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  other "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" pbjs "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br")])]),n("p",[s._v("于生产环境，建议将所有的"),n("code",[s._v(".proto")]),s._v("文件绑定到一个"),n("code",[s._v(".json")]),s._v("文件中，这样可以最小化网络请求的数量，并避免任何解析器开销(提示:只使用light库):")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" pbjs -t json file1.proto file2.proto "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" bundle.json\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("现在，在你的打包文件中引入这个文件：")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" root "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" protobuf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Root"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("fromJSON")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./bundle.json"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("或者用通常的方式加载:")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[s._v("protobuf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("load")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bundle.json"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" root")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ...")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("另一方面，只使用"),n("code",[s._v("minimal")]),s._v("库生成的静态代码。例如：")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" pbjs -t static-module -w commonjs -o compiled.js file1.proto file2.proto\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("这将为"),n("code",[s._v("file1.proto")]),s._v("和"),n("code",[s._v("file2.proto")]),s._v("中的定义生成静态代码，并编译为一个"),n("code",[s._v("CommonJS")]),s._v("模块"),n("code",[s._v("compiled.js")]),s._v("。")]),s._v(" "),n("p",[n("strong",[s._v("咚咚咚！")]),s._v(" 使用"),n("code",[s._v("/** ... */")]),s._v("块或尾部添加"),n("code",[s._v("/// ...")]),s._v("行来标识的"),n("code",[s._v(".proto")]),s._v("文件会转化为生成的静态代码。")]),s._v(" "),n("h2",{attrs:{id:"typescript"}},[s._v("TypeScript")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从带注释的 JavaScript 文件生成 TypeScript 定义")]),s._v("\n\n  -o, --out       "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存到一个文件，而非写到标准输出流中.")]),s._v("\n\n  -g, --global    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 浏览器环境中全局对象的名称(如果有的话).")]),s._v("\n\n  --no-comments   "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不输出任何 JSDoc 注释.")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 内部参数:")]),s._v("\n\n  -n, --name      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将所有内容封装在具有指定名称的模块中.")]),s._v("\n\n  -m, --main      "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 是否在没有任何导入的情况下构建主库.")]),s._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用法： ")]),s._v("\n  pbts "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" file1.js file2.js "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("or"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  other "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" pbts "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" -\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("参照上面的例子，下面的代码不仅生成了 CommonJS 模块的静态代码"),n("code",[s._v("compiled.js")]),s._v("，还生成了相应的 TypeScript 定义文件"),n("code",[s._v("compiled.d.ts")]),s._v(":")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" pbjs -t static-module -w commonjs -o compiled.js file1.proto file2.proto\n$"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" pbts -o compiled.d.ts compiled.js\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[s._v("此外，静态模块的 TypeScript 定义与基于反射的对应组件(即由 JSON 模块导出)兼容，只要满足以下条件:")]),s._v(" "),n("ol",[n("li",[s._v("不要使用"),n("code",[s._v("new SomeMessage(...)")]),s._v("，而应该使用"),n("code",[s._v("SomeMessage.create(...)")]),s._v("因为反射对象并不会提供构造函数。")]),s._v(" "),n("li",[s._v("类型、服务和枚举必须以大写字母开头才可以作为反射类型的属性(即能够使用"),n("code",[s._v("MyMessage.MyEnum")]),s._v("而非"),n("code",[s._v('root.lookup("MyMessage.MyEnum")')]),s._v(")。")])]),s._v(" "),n("p",[s._v("例如，下面的指令生成一个 JSON 模块"),n("code",[s._v("bundle.js")]),s._v("和一个"),n("code",[s._v("bundle.d.ts")]),s._v("，但没有静态代码:")]),s._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[s._v("$"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" pbjs -t json-module -w commonjs -o bundle.js file1.proto file2.proto\n$"),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" pbjs -t static-module file1.proto file2.proto "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" pbts -o bundle.d.ts -\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("h2",{attrs:{id:"反射与静态代码"}},[s._v("反射与静态代码")]),s._v(" "),n("p",[s._v("虽然直接使用"),n("code",[s._v(".proto")]),s._v("文件分别需要支持纯反射的的完整库/JSON 的 light 库，但是除了相对简短的描述符之外，几乎所有的代码都是共享的。")]),s._v(" "),n("p",[s._v("另一方面，静态代码只需 minimal 库就可以，但会生成没有任何反射特性的附加源代码。这也意味着存在一个盈亏平衡点，即当生成的代码数量超过完整的 light 库的大小时，静态生成的代码就会大于基于描述符的代码。")]),s._v(" "),n("p",[s._v("在性能方面并没有太大的区别，因为静态生成的代码与运行时生成的代码基本相同，而且正如前一节所示，两者在很大程度上是可互换的。")]),s._v(" "),n("table",[n("thead",[n("tr",[n("th",{staticStyle:{"text-align":"center"}},[s._v("资源")]),s._v(" "),n("th",{staticStyle:{"text-align":"center"}},[s._v("库")]),s._v(" "),n("th",[s._v("优点")]),s._v(" "),n("th",[s._v("权衡")])])]),s._v(" "),n("tbody",[n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v(".proto")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("full")]),s._v(" "),n("td",[s._v("易于编辑"),n("br"),s._v("与其他库的互操作性"),n("br"),s._v("没有编译步骤")]),s._v(" "),n("td",[s._v("一些解析和可能的网络开销")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("JSON")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("light")]),s._v(" "),n("td",[s._v("易于编辑"),n("br"),s._v("没有解析开销"),n("br"),s._v("单个包(无网络开销)")]),s._v(" "),n("td",[s._v("特定的 protobuf.js"),n("br"),s._v("需要编译步骤")])]),s._v(" "),n("tr",[n("td",{staticStyle:{"text-align":"center"}},[s._v("static")]),s._v(" "),n("td",{staticStyle:{"text-align":"center"}},[s._v("minimal")]),s._v(" "),n("td",[s._v("可以在"),n("code",[s._v("eval")]),s._v("访问受限的地方工作"),n("br"),s._v("完全文档化"),n("br"),s._v("小 proto 占用更小")]),s._v(" "),n("td",[s._v("很难编辑"),n("br"),s._v("无反射"),n("br"),s._v("需要编译步骤")])])])]),s._v(" "),n("h2",{attrs:{id:"command-line-api"}},[s._v("Command line API")]),s._v(" "),n("p",[s._v("这两个实用程序可以通过提供命令行参数和回调各自的"),n("code",[s._v("main")]),s._v("函数来使用:")]),s._v(" "),n("div",{staticClass:"language-js line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("var")]),s._v(" pbjs "),n("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"protobufjs/cli/pbjs"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// 或 require("protobufjs/cli").pbjs / .pbts')]),s._v("\n\npbjs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--target"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"json-module"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[s._v('"path/to/myproto.proto"')]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" output")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throw")]),s._v(" err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 使用输出搞事情")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);